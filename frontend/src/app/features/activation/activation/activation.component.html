<div
  class="min-vh-100 bg-orange position-relative overflow-hidden d-flex flex-column align-items-center justify-content-center py-4"
>
  <!-- Floating Elements -->
  <div class="floating-elements">
    <div
      *ngFor="let element of floatingElements; let i = index"
      class="floating-element"
      [style.top]="element.top"
      [style.left]="element.left"
      [style.animation-delay]="element.delay">
      <i [class]="element.icon"></i>
    </div>
  </div>

  <!-- Activation Card -->
  <div
    class="activation-card bg-white rounded-4 p-4 p-md-5 position-relative z-2 mx-3 mb-3"
  >
    <div class="w-100" style="max-width: 500px">
      <!-- Welcome Message -->
      <div class="text-center mb-4">
        <p class="text-muted">
          Aplikasi ini memerlukan aktivasi sebelum dapat digunakan
        </p>
      </div>

      <!-- Step 1: Download Machine File -->
      <div class="activation-step mb-5">
        <div class="d-flex align-items-center mb-3">
          <div
            class="step-number bg-orange text-white rounded-circle d-flex align-items-center justify-content-center me-3"
            style="
              width: 30px;
              height: 30px;
              font-size: 0.875rem;
              font-weight: 600;
            "
          >
            1
          </div>
          <h5 class="mb-0 fw-semibold text-dark">Download Machine File</h5>
        </div>
        <p class="text-muted mb-3 ms-5">
          Download file informasi mesin untuk proses aktivasi
        </p>
        <div class="ms-5">
          <button
            type="button"
            class="btn btn-outline-orange btn-lg px-4"
            (click)="downloadMachineFile()"
          >
            <i class="fas fa-download me-2"></i>
            Download Machine File
          </button>
        </div>
      </div>

      <!-- Step 2: Upload License File -->
      <div class="activation-step mb-4">
        <div class="d-flex align-items-center mb-3">
          <div
            class="step-number bg-orange text-white rounded-circle d-flex align-items-center justify-content-center me-3"
            style="
              width: 30px;
              height: 30px;
              font-size: 0.875rem;
              font-weight: 600;
            "
          >
            2
          </div>
          <h5 class="mb-0 fw-semibold text-dark">Upload License File</h5>
        </div>
        <p class="text-muted mb-3 ms-5">
          Upload file signature (*.sig) yang diberikan oleh administrator
        </p>

        <div class="ms-5">
          <!-- Upload Area -->
          <div
            class="upload-area border border-2 border-dashed rounded-3 p-4 text-center position-relative"
            [class.border-orange]="isDragOver"
            [class.bg-light]="!isDragOver"
            [class.bg-orange-light]="isDragOver"
            (dragover)="onDragOver($event)"
            (dragleave)="onDragLeave($event)"
            (drop)="onDrop($event)"
            (click)="fileInput.click()"
            style="cursor: pointer; transition: all 0.3s ease"
          >
            <div class="upload-content">
              <i
                class="fas fa-cloud-upload-alt text-orange mb-3"
                style="font-size: 2.5rem"
              ></i>
              <h6 class="fw-semibold text-dark mb-2">
                Klik di sini atau drag & drop file
              </h6>
              <p class="text-muted small mb-0">
                File yang didukung: *.sig, *.json
              </p>
            </div>

            <input
              #fileInput
              type="file"
              accept=".sig,.json"
              style="display: none"
              (change)="onFileSelected($event)"
            />
          </div>

          <!-- Selected File Info -->
          <div
            *ngIf="selectedFile"
            class="selected-file mt-3 p-3 bg-light rounded-3 border"
          >
            <div class="d-flex align-items-center justify-content-between">
              <div class="d-flex align-items-center">
                <i class="fas fa-file-alt text-orange me-2"></i>
                <div>
                  <h6 class="mb-0 fw-semibold">{{ selectedFile.name }}</h6>
                  <small class="text-muted"
                    >{{ (selectedFile.size / 1024).toFixed(1) }} KB</small
                  >
                </div>
              </div>
              <button
                type="button"
                class="btn btn-sm btn-outline-danger"
                (click)="selectedFile = null; errorMessage = ''"
              >
                <i class="fas fa-times"></i>
              </button>
            </div>
          </div>

          <!-- Verify Button -->
          <div *ngIf="selectedFile" class="mt-3">
            <button
              type="button"
              class="btn btn-orange btn-lg w-100 py-3"
              [disabled]="isVerifying"
              (click)="verifyAndActivate()"
            >
              <span
                *ngIf="isVerifying"
                class="spinner-border spinner-border-sm me-2"
              ></span>
              <i *ngIf="!isVerifying" class="fas fa-shield-check me-2"></i>
              {{ isVerifying ? "Memverifikasi..." : "Verifikasi & Aktivasi" }}
            </button>
          </div>
        </div>
      </div>

      <!-- Error Message -->
      <div
        class="alert alert-danger d-flex align-items-center"
        *ngIf="errorMessage"
        role="alert"
      >
        <i class="fas fa-exclamation-triangle me-2"></i>
        <div>{{ errorMessage }}</div>
      </div>

      <!-- Footer -->
      <div class="text-center mt-4">
        <p class="text-muted small mb-0">
          Â© 2024 Carwash Management System. All rights reserved.
        </p>
      </div>
    </div>
  </div>
</div>
